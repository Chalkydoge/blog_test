---
title: low_latency_5g
date: 2023-10-07 11:04:48
tags:
- 5G
- 云原生

---

蜂窝网络控制程序（例如，移动性、空闲-活动转换以节省能源）直接影响数据平面行为，影响用户体验延迟。
L25GC实现了分页，并实现了避免3GPP的智能切换方案。

<!-- more -->

# 摘要

蜂窝网络控制程序（例如，移动性、空闲-活动转换以节省能源）直接影响数据平面行为，影响用户体验延迟。
识别此控制数据平面相互依赖，L25GC重新构建5G核心（5GC）网络及其处理，以减少控制平面操作的延迟和它们对数据平面的影响。
利用共享内存，L25GC消除消息序列化和 HTTP 处理开销，同时符合 3GPP 标准。我们改进数据平面通过分解函数进行处理，以避免控制数据平面干扰和使用可扩展的流级数据包分类器转发规则查找。
利用5GC的缓冲区，L25GC实现了分页，并实现了避免3GPP的智能切换方案。

发夹路由，以及 5G 基站有限缓冲导致的数据丢失，减少延迟和不必要的消息处理。
 L25GC 的集成故障恢复能力可透明地从5GC软件网络功能和硬件故障很多
 比 3GPP 的重新连接恢复程序更快。L25GC 建成

基于 free5GC，一个基于开源内核的 5GC 实现。L25GC 将多个控制平面事件的事件完成时间缩短了 ∼50%，并改善了数据包延迟（由于改进了控制平面通信）
在寻呼和切换期间 ∼2×事件，与free5GC相比。L25GC的设计是通用的，尽管当前实现支持有限数量的用户会话。

# 背景介绍

在5G蜂窝生态系统中，实现了蜂窝组件；
作为基于软件的云原生服务，实现部署灵活性。但是，随着5G核心网（5GC）中的控制平面过程与传统的4G类似[49]，它没有充分利用全部优势。


网络功能（NF）的软件化。
蜂窝核心预计将经历更多的控制平面流量，由于：
1. 蜂窝用户的大量增长，包括物联网和机器对机器设备[31]
2. 频繁切换：由于单元格大小减小而导致的事件。用户事件完成时间，比如一个需要1.9秒的交接过程（如[45]所示），会直接影响最终用户数据包。
3. 除了由于传统而受到的处罚蜂窝控制平面核心程序，我们识别几个额外的会导致延迟的问题（详见 §2.3）：

- 采用HTTP / REST进行NF间通信，表面上是为了支持“解聚合”的想法，但存在开销。消息序列化和 TCP 处理。
- 由 3GPP 标准驱动的当前实施（§5.2.1[8]），在列表中组织转发（匹配操作）规则并执行查找匹配规则的低效线性搜索。
- 用户在切换期间可能会遇到更高的数据包丢失到当前的发夹和菊花链路由，以及有限的缓冲区在目标 gNB（5G 基站）上。
- 在故障期间，当前的3GPP恢复过程要求用户重新启动连接建立请求并重新开始。这直接影响正在进行的数据连接（例如，TCP 体验）虚假超时），影响 QoE。

什么是hairpin和daisy-chain路由

{% asset_img 5g_core_arch.png 5G核心网络的主要组成结构 %}

# 相关工作

1. 降低控制平面的延迟：Neutrino做到快速序列化+大的地理范围内维护用户状态的副本
2. 优化5GC的SBI：Buyakar 通过gRPC取代HTTP/REST的方式实现服务接口
3. 蜂窝核心网络的可用性提升：ECHO 提出了4G 分布式 状态机复制的协议
4. 重新设计控制平面流程：CleanG 可扩展的基于NFV的架构优化控制/数据平面的延迟。 共享内存(DPDK特性)
5. 利用客户段的状态： DPCM 客户端的解决方案-初始化+执行控制操作 与此同时 利用用户设备端的状态信息来降低控制平面的延迟

# 现有框架的挑战

## 挑战1：控制消息的处理

实际上，相对于4G，5G中交换的控制消息数量略有增加，以保持用户状态在多个分解NF中的一致性[6]。
交换这些消息的成本很高，由于几个因素，包括消息序列化、HTTP/TCP 开销。
通信开销将更高：如果 NF 放置在节点上。这成为一个问题，因为5G网络部署和应用不断发展，例如支持物联网，这可能会增加控制平面流量[31]。

## 挑战2：复杂的交接流程

切换操作最多可能需要 1.9秒 [45] 完成。这可能会影响数据平面流量。
例如，基于 TCP 的数据流量可能会遭受虚假超时，这会降低应用程序吞吐量。

与4G基站不同，gNB可能相对较小，缓冲能力有限。

每个基站的缓存大小约为1300个完整的MTU(每一个radio resource-connected的UE) 

X2/S1等数据转发技术带来额外的延迟+数据丢失的问题

hairpin-back 流量返回5G核心网络 5GC, 再转发到目标的gNB

## 挑战3：开销很大的规则匹配过程

UE将不仅仅是指用户的一个具体的移动端设备
一个5G的家庭网关可以同时操作多个5G通信的会话，请求不同类型的服务
数据包将会携带不同层级的QoS信息

5GC需要提供一个可变的QoS模型，QoS的粒度需要设计在每个数据流上。
引出了 多IP层级的网络数据流模型=5G网络场景，因此就需要

{% asset_img user_session.png 一个用户的会话中所涉及的多个数据流 %}

目前试图在5G的数据平面中提供的过滤字段
- Service Data Flow (SDF) filter
- Ethernet Packet Filter

在数据包中添加过滤字段 = 大量的PDR(Packet Detection Rules)被按照每个数据包的频率进行扫描

## 挑战4：网络功能的可靠性和可恢复性

从故障中回复，3GPP提出了需要额外的控制信息，用于恢复5G网络Network Function中的内容

等待完成的连接需要等待一系列的上下文完成恢复之后才能够进行。但是这一过程的延迟巨大，而且可能带来数据包丢失的问题。

This need for reattachment can be avoided by replicating the primary NFs. 
就是说可以通过复制最初的NF来实现避免恢复上下文的操作。

在主数据库发生故障时，主动复制需要状态信息切换到活动备用数据库，但是，为此类 NF 维护强一致性副本可能会影响正常性能。

尽管现有技术（例如，使用延迟检查点和完全检查进行数据包重放指向）在NFV环境中运行良好，5GC构成显着影响

由于控制平面和数据平面之间紧密的相互依赖性，需要对其设计进行实质性的增强，因此存在挑战。

此外，持续运行的副本会消耗系统资源。我们需要一个策略来缩短恢复时间，协调控制平面状态与数据平面，并确保一致性无需消耗额外资源。
